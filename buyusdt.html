<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بطاقات الهدايا</title>
    <style>
        /* تنسيق الشبكة */
        .giftcards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 20px;
        }
        .giftcard {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .giftcard img {
            max-width: 100%;
            border-radius: 8px;
        }
        .giftcard:hover {
            transform: scale(1.05);
        }

        /* تنسيق النافذة المنبثقة */
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .popup-content-container {
            background: white;
            width: 50%;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            gap: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }
        .popup-left {
            flex: 1;
        }
        .popup-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .popup-close {
            background: #f44336;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            align-self: flex-end;
        }
        .popup-close:hover {
            background: #d32f2f;
        }
        .popup-image {
            max-width: 100%;
            border-radius: 8px;
        }
        .purchase-button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 8px;
            text-align: center;
        }
        .purchase-button:hover {
            background: #388e3c;
        }
    </style>
</head>
<body>
    <!-- شبكة البطاقات -->
    <div class="giftcards-grid" id="giftcards-container"></div>

    <!-- النافذة المنبثقة -->
    <div class="popup">
        <div class="popup-content-container">
            <button class="popup-close">Close</button>
            <!-- القسم الأيسر -->
            <div class="popup-left">
                <img id="popup-image" class="popup-image" src="" alt="Card Image">
            </div>
            <!-- القسم الأيمن -->
            <div class="popup-right">
                <div>
                    <h2 id="popup-title"></h2>
                    <p id="popup-description"></p>
                </div>
                <button class="purchase-button" id="purchase-button">Buy now</button>
            </div>
        </div>
    </div>
    <script>
let giftCardsData = [];

// دالة لجلب بيانات بطاقات الهدايا من الرابط المحدد
function fetchGiftCards(filePath) {
    fetch(filePath)
        .then(response => response.json())
        .then(giftCards => {
            giftCardsData = giftCards;
            displayGiftCards(giftCardsData); // عرض بطاقات الهدايا
        })
        .catch(error => console.error('Error fetching gift card data:', error));
}

// إعداد عرض بطاقات الهدايا عند تحميل الصفحة
document.addEventListener('DOMContentLoaded', function() {
    // عرض بطاقات الهدايا عند تحميل الصفحة
    fetchGiftCards('https://cryptolike.store/tcards/tcards.json');
});

// دالة لعرض بطاقات الهدايا على شكل شبكة
function displayGiftCards(cards) {
    const container = document.getElementById('giftcards-container');
    container.innerHTML = ''; // إعادة تعيين المحتوى
    cards.forEach(card => {
        const cardDiv = document.createElement('div');
        cardDiv.className = 'giftcard';
        cardDiv.innerHTML = `<img src="${card.card_image_url}" alt="${card.name}" class="card-image">`;
        container.appendChild(cardDiv);

        // إضافة حدث النقر على الصورة لإظهار النافذة المنبثقة
        cardDiv.querySelector('.card-image').addEventListener('click', function() {
            showPopup(card); // استدعاء دالة لعرض النافذة المنبثقة
        });
    });
}

// دالة لإظهار النافذة المنبثقة بمعلومات البطاقة
function showPopup(card) {
    document.getElementById('popup-title').innerText = card.name;
    document.getElementById('popup-image').src = card.card_image_url;
    
    let popupContent = [];
    
    // إضافة الحقول فقط إذا كانت موجودة
    if (card.category) popupContent.push(`<p><strong>Category:</strong> ${card.category}</p>`);
    if (card.description) popupContent.push(`<p><strong>Description:</strong> ${card.description}</p>`);
    if (card.currency_code) popupContent.push(`<p><strong>Currency:</strong> ${card.currency_code}</p>`);
    if (card.min_amount) popupContent.push(`<p><strong>Minimum Amount:</strong> ${card.min_amount} ${card.currency_code}</p>`);
    if (card.max_amount) popupContent.push(`<p><strong>Maximum Amount:</strong> ${card.max_amount} ${card.currency_code}</p>`);
    if (card.expiry_and_validity) popupContent.push(`<p><strong>Expiry:</strong> ${card.expiry_and_validity}</p>`);
    popupContent.push(`<p><strong>Product ID:</strong> ${card.product_id}</p>`);
    
    // إضافة كيفية الاستخدام (how_to_use) إذا كانت موجودة
    if (card.how_to_use) {
        popupContent.push(`<p><strong>How to Use:</strong><br>${card.how_to_use.replace(/\n/g, "<br>")}</p>`); // التعامل مع الأسطر الجديدة (newline)
    }

    // فقط إضافة Denominations إذا كانت القيمة موجودة في JSON
    if (card.denominations && card.denominations !== "") {
        popupContent.push(`<p><strong>Denominations:</strong> ${card.denominations}</p>`);
    }

    // دمج المحتوى فقط إذا كانت الحقول موجودة
    document.getElementById('popup-content').innerHTML = popupContent.join('');

    // إنشاء الزر هنا
    const purchaseButton = document.createElement('button');
    purchaseButton.className = 'purchase-button';
    purchaseButton.innerText = 'Buy now';
    document.getElementById('popup-content').appendChild(purchaseButton);

    // إضافة حدث النقر على زر الشراء
    purchaseButton.addEventListener('click', function() {
        const selectedCountry = document.getElementById('country-select').value; // الحصول على الدولة المحددة
        let orderUrl = '';

        // تحديد عنوان URL بناءً على الدولة
        switch (selectedCountry) {
            case 'saudi-arabia':
            case 'united-arab-emirates':
                orderUrl = `https://cryptolike.store/giftcards/order.html?name=${encodeURIComponent(card.name)}&product_id=${encodeURIComponent(card.product_id)}&denominations=${encodeURIComponent(card.denominations)}`;
                break;
            case 'germany':
                orderUrl = `https://cryptolike.store/giftcards/order.html?name=${encodeURIComponent(card.name)}&product_id=${encodeURIComponent(card.product_id)}&denominations=${encodeURIComponent(card.denominations)}`;
                break;
        }

        // توجيه المستخدم إلى صفحة الطلب
        if (orderUrl) {
            window.location.href = orderUrl;
        }
    });

    // إظهار النافذة المنبثقة
    document.querySelector('.popup').style.display = 'block';
    document.querySelector('.popup-overlay').style.display = 'block';
}

// إغلاق النافذة المنبثقة
document.querySelector('.popup-close').addEventListener('click', function() {
    document.querySelector('.popup').style.display = 'none';
    document.querySelector('.popup-overlay').style.display = 'none';
    document.querySelector('.denomination-dropdown')?.remove(); // إزالة القائمة المنسدلة عند الإغلاق
});

    </script>
</body>
</html>
